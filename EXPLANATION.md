# Простое объяснение: Как работает интеграция Frontend и Backend

## Общая картина

Представь, что у тебя есть два компьютера:
- **Frontend (React)** - это то, что видит пользователь (кнопки, карточки, формы)
- **Backend (FastAPI/Python)** - это "мозг" приложения, который хранит данные и принимает решения

Они общаются через **HTTP запросы** - это как письма, которые они отправляют друг другу.

---

## 1. Конфигурация API (src/config/api.js)

**Что это:**
Файл, где хранятся все адреса (URL) для общения с бэкендом.

**Как работает:**
- Вместо того, чтобы писать `http://localhost:8080/api/profiles` каждый раз, мы создаем переменную `API_ENDPOINTS.PROFILES`
- Если нужно изменить адрес бэкенда, меняем в одном месте
- Переменная окружения `.env` позволяет менять адрес для разработки и продакшена

**Аналогия:** Это как адресная книга - все контакты в одном месте.

---

## 2. Создание профиля (ProfileForm.jsx)

**Что происходит:**
1. Пользователь заполняет форму (имя, возраст, фото и т.д.)
2. Нажимает "Сохранить"
3. Frontend собирает все данные в специальный формат (FormData) - это как упаковка посылки
4. Отправляет POST запрос на бэкенд: `POST /api/profiles`
5. Бэкенд получает данные, сохраняет в базу данных
6. Бэкенд отвечает: "Всё ок, профиль создан!"

**Код делает:**
```javascript
// Собираем данные
formDataToSend.append('name', formData.name);
formDataToSend.append('age', formData.age);
// ... и т.д.

// Отправляем на бэкенд
fetch(API_ENDPOINTS.PROFILES, {
  method: 'POST',
  body: formDataToSend
})
```

**Аналогия:** Как заполнить анкету и отправить её в офис. Офис (бэкенд) сохраняет её в папку (база данных).

---

## 3. Загрузка списка профилей (Profiles.jsx)

**Что происходит:**
1. Пользователь открывает страницу "Анкеты"
2. Frontend автоматически отправляет GET запрос: `GET /api/profiles?userId=123&city=Москва`
3. Бэкенд ищет в базе данных подходящие профили (исключая уже просмотренные)
4. Бэкенд отправляет список обратно
5. Frontend показывает карточки на экране

**Код делает:**
```javascript
// Когда компонент загружается, автоматически делаем запрос
useEffect(() => {
  fetch(`${API_ENDPOINTS.PROFILES}?userId=${userInfo.id}`)
    .then(response => response.json())
    .then(data => setAllProfiles(data.content))
}, [userInfo])
```

**Аналогия:** Как зайти в библиотеку и попросить книги по определённой теме. Библиотекарь (бэкенд) находит и приносит тебе книги (профили).

**Важно:** `useEffect` - это как "автоматический помощник", который выполняет действие при загрузке страницы или изменении данных.

---

## 4. Лайк профиля (Profiles.jsx - handleLike)

**Что происходит:**
1. Пользователь нажимает кнопку ❤️
2. Frontend отправляет POST запрос: `POST /api/profiles/2/like` с данными `{userId: 123}`
3. Бэкенд сохраняет действие "лайк" в базу данных
4. Бэкенд проверяет: "А этот пользователь тоже лайкнул первого?"
5. Если да - создаёт мэтч и отвечает: `{matched: true}`
6. Frontend показывает сообщение "Вы замэтчились!"

**Код делает:**
```javascript
const handleLike = async () => {
  // Отправляем запрос
  const response = await fetch(API_ENDPOINTS.LIKE_PROFILE(profileId), {
    method: 'POST',
    body: JSON.stringify({ userId: userInfo.id })
  })
  
  const data = await response.json()
  if (data.matched) {
    alert('Вы замэтчились!')
  }
}
```

**Аналогия:** Как поставить лайк в соцсети. Система проверяет, лайкнул ли другой человек тебя, и если да - вы становитесь друзьями (мэтч).

**Важно:** `async/await` - это способ дождаться ответа от бэкенда, прежде чем продолжить.

---

## 5. Пропуск профиля (Profiles.jsx - handlePass)

**Что происходит:**
1. Пользователь нажимает ✕
2. Frontend отправляет POST запрос: `POST /api/profiles/2/pass`
3. Бэкенд сохраняет: "Пользователь 123 пропустил профиль 2"
4. Этот профиль больше не будет показываться пользователю
5. Frontend переходит к следующему профилю

**Аналогия:** Как пролистать страницу в книге - ты её уже видел, больше не вернёшься.

---

## 6. Загрузка мэтчей (NetworkList.jsx)

**Что происходит:**
1. Пользователь открывает страницу "Нетворкинг-лист"
2. Frontend отправляет GET запрос: `GET /api/matches?userId=123`
3. Бэкенд ищет все мэтчи этого пользователя
4. Бэкенд возвращает список профилей, с которыми есть мэтч
5. Frontend показывает карточки мэтчей

**Код делает:**
```javascript
useEffect(() => {
  fetch(`${API_ENDPOINTS.MATCHES}?userId=${userInfo.id}`)
    .then(response => response.json())
    .then(data => setMatchedProfiles(data))
}, [userInfo])
```

**Аналогия:** Как открыть список друзей - система показывает всех, с кем у тебя взаимный лайк.

---

## 7. Просмотр конкретного профиля (UserCard.jsx)

**Что происходит:**
1. Пользователь кликает на профиль
2. Frontend берёт ID из URL (например, `/profiles/5`)
3. Отправляет GET запрос: `GET /api/profiles/5`
4. Бэкенд находит профиль с ID=5 и отправляет все данные
5. Frontend показывает полную информацию

**Код делает:**
```javascript
const { id } = useParams() // Берём ID из URL

useEffect(() => {
  fetch(API_ENDPOINTS.PROFILE_BY_ID(id))
    .then(response => response.json())
    .then(data => setProfile(data))
}, [id])
```

**Аналогия:** Как открыть страницу человека в соцсети - система находит его по ID и показывает профиль.

---

## 8. Обработка ошибок (src/utils/api.js)

**Что это:**
Функция, которая проверяет, успешно ли прошёл запрос.

**Как работает:**
- Если бэкенд отвечает ошибкой (например, 404 или 500), функция выбрасывает ошибку
- Frontend может показать пользователю понятное сообщение

**Код делает:**
```javascript
export const handleApiError = async (response) => {
  if (!response.ok) {
    throw new Error('Ошибка сервера')
  }
  return response.json()
}
```

**Аналогия:** Как проверка на почте - если письмо не дошло, тебе об этом скажут.

---

## 9. Fallback (резервные данные)

**Что это:**
Если бэкенд недоступен или вернул ошибку, приложение показывает "моковые" (тестовые) данные вместо пустого экрана.

**Зачем:**
- Пользователь может продолжать тестировать приложение
- Разработчик видит, как будет выглядеть интерфейс
- Приложение не "ломается" при проблемах с бэкендом

**Аналогия:** Как запасной план - если основной путь закрыт, идёшь обходным.

---

## 10. Переменные окружения (.env)

**Что это:**
Файл с настройками, который не попадает в Git (секретные данные).

**Как работает:**
- В разработке: `REACT_APP_API_BASE_URL=http://localhost:8080`
- В продакшене: `REACT_APP_API_BASE_URL=https://api.myapp.com`
- Код использует эту переменную автоматически

**Аналогия:** Как адрес офиса - в разработке это твой компьютер, в продакшене - реальный сервер.

---

## Основные понятия

### HTTP методы:
- **GET** - "Дай мне данные" (чтение)
- **POST** - "Сохрани эти данные" (создание/отправка)

### Асинхронность (async/await):
- Запрос к бэкенду занимает время (секунды)
- `async/await` позволяет дождаться ответа, не блокируя интерфейс

### useEffect:
- Автоматически выполняет код при загрузке компонента или изменении данных
- Как "слушатель" - реагирует на изменения

### useState:
- Хранит данные компонента (например, список профилей)
- При изменении автоматически обновляет интерфейс

---

## Как объяснить другому человеку

**Короткая версия:**
"Frontend - это интерфейс, который видит пользователь. Backend - это сервер, который хранит данные. Они общаются через HTTP запросы. Когда пользователь что-то делает (лайкает, создаёт профиль), Frontend отправляет запрос на Backend, Backend обрабатывает и отвечает. Frontend получает ответ и обновляет экран."

**Детальная версия:**
1. Покажи файл `src/config/api.js` - объясни, что это адреса для общения
2. Покажи пример запроса в `ProfileForm.jsx` - объясни, как данные отправляются
3. Покажи `useEffect` в `Profiles.jsx` - объясни, как данные загружаются автоматически
4. Покажи обработку ошибок - объясни, что приложение не должно "ломаться"

**Визуальная аналогия:**
- Frontend = официант в ресторане (принимает заказ, приносит еду)
- Backend = кухня (готовит, хранит ингредиенты)
- HTTP запросы = заказы и готовые блюда
- База данных = холодильник с продуктами

---

## Важные моменты для понимания

1. **Все запросы асинхронные** - нужно ждать ответа
2. **Ошибки обрабатываются** - приложение не должно "падать"
3. **Данные преобразуются** - формат с бэкенда может отличаться от формата для отображения
4. **Fallback данные** - если бэкенд недоступен, показываем тестовые данные
5. **Автоматическая загрузка** - `useEffect` загружает данные при открытии страницы

---

## Типичные вопросы и ответы

**Q: Почему данные не появляются сразу?**
A: Потому что запрос к бэкенду занимает время. Показываем индикатор загрузки.

**Q: Что если бэкенд не работает?**
A: Показываем fallback данные или сообщение об ошибке. Приложение продолжает работать.

**Q: Как изменить адрес бэкенда?**
A: Измени переменную `REACT_APP_API_BASE_URL` в файле `.env`

**Q: Почему используется async/await?**
A: Чтобы дождаться ответа от бэкенда, не блокируя интерфейс.

**Q: Что такое useEffect?**
A: Хук React, который выполняет код при загрузке компонента или изменении зависимостей.

